<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>R Notebook - Swayer</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "R Notebook";
        var mkdocs_page_input_path = "07 Intermediate Applied Statistics/Quiz3.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Swayer
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">CPA Data Analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../000%20CPA%20Data%20Analysis/likelihood/">Likelihood</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Swayer</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">R Notebook</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="intermediate-applied-statistics-quiz-iii">Intermediate Applied Statistics Quiz III</h2>
<h4 id="1">1.</h4>
<h4 id="2a-write-the-likelihood-functions">2.(a) Write the likelihood functions</h4>
<p>X와 Y가 독립이므로 둘의 joint likelihood는 아래와 같다.</p>
<p><span class="arithmatex">\(X \sim B(m,p_1),\ Y \sim B(n,p_2)\)</span> </p>
<p><span class="arithmatex">\(L(p_1,p_2)=\ p_1^x(1-p_1)^{(m-x)}p_2^y(1-p_2)^{(n-y)}\)</span></p>
<h4 id="2b-rewrite-the-likelihood-function-in-terms-of-theta-logfracp_11-p_1p_21-p_2-and-eta-logfracp_21-p_2">2.(b) Rewrite the likelihood function in terms of <span class="arithmatex">\(\theta = log\frac{p_1(1-p_1)}{p_2(1-p_2)}\  and\  \eta = log\frac{p_2}{1-p_2}\)</span></h4>
<p><span class="arithmatex">\(p_1 = \frac{e^{\eta}}{1+e^{\eta}},\ p_2 = \frac{e^{\theta + \eta}}{1+ e^{\theta+\eta}}.\)</span></p>
<p><span class="arithmatex">\(L(\theta, \eta) = (\frac{p_1}{1-p_1})^x(1-p_1)^m(\frac{p_2}{1-p_2})^y(1-p_2)^n\)</span></p>
<p><span class="arithmatex">\(= (\frac{p_1/(1-p_1)}{p_2/(1-p_2)})^x(\frac{p_2}{1-p_2})^{x+y}(1-p_1)^m(1-p_2)^n\)</span></p>
<p><span class="arithmatex">\(= e^{{\theta}x}e^{\eta(x+y)}(1+e^{\theta+\eta})^{-m}(1-p_2)^n\)</span></p>
<h4 id="2c-use-the-profile-likelihood-to-get-the-mle-of-theta">2.(c) Use the profile likelihood to get the mle of <span class="arithmatex">\(\theta\)</span></h4>
<p>여기서 target parameter는 <span class="arithmatex">\(\theta\)</span>일 것이고, <span class="arithmatex">\(\eta\)</span>가 nuisance parameter이기 때문에 at each fixed value <span class="arithmatex">\(\theta\)</span>에서 <span class="arithmatex">\(\eta\)</span>의 mle를 구하는 것이 profile likelihood를 찾는 것이다</p>
<p>이를 계산해보면</p>
<p><span class="arithmatex">\(Let\ \frac{\partial{L(\theta,\eta)}}{\partial\eta} = {\theta}x + \eta(x+y) -mlog(1+e^{\theta+\eta}) - nlog(1+e^{\eta}) = 0\)</span></p>
<p>허나 이 식은 MLE에 대한 closed form을 갖지 않으므로 numerical 한 방법으로 profile likelihood를 구할 수 있다.</p>
<p><span class="arithmatex">\(L(\theta)= max_\eta{L(\theta,\eta)}\)</span>.</p>
<p><span class="arithmatex">\(\theta\)</span>의 MLE는 invariance property에 의해 다음과 같다.</p>
<p><span class="arithmatex">\(\hat{\theta} = log\frac{x/(m-x)}{y/(n-y)}\)</span>.</p>
<h4 id="3a-e">3.(a)-(e)</h4>
<pre><code class="language-r">set.seed(2020311194)
obs &lt;- c(2.08, 2.6, 2.67, 2.7, 2.94, 3.08, 3.71, 4.66, 4.71, 5.2)
exp(mean(obs))
</code></pre>
<pre><code>## [1] 31.03141
</code></pre>
<pre><code class="language-r">iter &lt;- 5000
esti &lt;- rep(0,iter)

###Assume parent Normal###
for ( i in 1:iter) esti[i] &lt;- exp(mean(rnorm(10,mean(obs),sd(obs))))
print(sd(esti))
</code></pre>
<pre><code>## [1] 11.49627
</code></pre>
<pre><code class="language-r">###Assume Exponential###
for ( i in 1:iter) esti[i] &lt;- exp(mean(rexp(10,1/mean(obs))))
print(sd(esti))
</code></pre>
<pre><code>## [1] 253.4486
</code></pre>
<pre><code class="language-r">###Approximation method###

((exp(mean(obs)))^2)*(var(obs)/length(obs))
</code></pre>
<pre><code>## [1] 110.7054
</code></pre>
<pre><code class="language-r">###Bootstrap###
for ( i in 1:iter) esti[i] = exp(mean(sample(obs,10,replace=T)))
print(sd(esti))
</code></pre>
<pre><code>## [1] 11.3162
</code></pre>
<pre><code class="language-r">###Jackknife###
n = length(obs)
esti &lt;- rep(0,n)
lxbar &lt;- exp(mean(obs))
for ( i in 1:n) esti[i] &lt;- exp(mean(obs[-i]))
sqrt((n-1)*mean((esti-lxbar)^2))
</code></pre>
<pre><code>## [1] 10.28417
</code></pre>
<h3 id="3-f">3-(f)</h3>
<p>Bootstrap 방법이 분석자에 따라 다른 값들을 갖긴 하지만, sample 관측에 어려움을 느끼는 등의 제약이 있을 때 쉽게 응용할 수 있는 방법이므로, ootstrap의 방법을 채택하는 것을 선호한다.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
